<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.creditlink.dao.index.BankCardFourElementAddedTempDao">
	
	<!--银行卡四要素新增临时表索引  -->
	<sql id="busIndexBankFourElementAddedTempColumns">
		bibfat.ID id,
		bibfat.PRODUCTID productId,
		bibfat.MEMBERID memberId,
		bibfat.BANKCARD bankCard,
		bibfat.IP ip,
		bibfat.PATH path,
		bibfat.STATUS status,

		bibfat.CREATETIME createTime,
		bibfat.CREATEUSER createUser,
		bibfat.UPDATETIME updateTime,
		bibfat.UPDATEUSER updateUser		
	</sql>
	
	<!-- bus_index_bank_fourelement_added_temp表查询条件 -->
	<sql id="findBusIndexBankFourElementAddedTempCondition">
		<if test="id != null">
			and bibfat.ID = #{id}
		</if>
		<if test="productId != null">
			and bibfat.PRODUCTID = #{productId}
		</if>
		<if test="memberId != null">
			and bibfat.MEMBERID = #{memberId}
		</if>
		<if test="bankCard != null and bankCard !=''">
			and bibfat.BANKCARD = #{bankCard}
		</if>
		<if test="ip != null and ip !=''">
			and bibfat.IP = #{ip}
		</if>
		<if test="path != null and path !=''">
			and bibfat.PATH = #{path}
		</if>
		<if test="status != null and status !=''">
			and bibfat.STATUS = #{status}
		</if>
		
		<if test="createTime != null">
			and bibfat.CREATETIME = #{createTime}
		</if>
		<if test="createUser != null and createUser !=''">
			and bibfat.CREATEUSER = #{createUser}
		</if>
	</sql>
	
	<!--批量添加  -->
	<insert id="insertBatch" parameterType="java.util.List">
	insert into bus_index_bank_fourelement_added_temp(PRODUCTID,MEMBERID,BANKCARD,IP,PATH,CREATETIME,CREATEUSER)
		values
		<foreach collection="list" item="item" separator=",">
			(
				#{item.productId},
				#{item.memberId},
				#{item.bankCard},
				#{item.ip},
				#{item.path},
				#{item.createTime},
				#{item.createUser}
			)
		</foreach>
	</insert>
	
	<!-- 查询 -->
	<select id="find" parameterType="com.creditlink.bean.po.index.BankCardFourElementAddedTempPo" resultType="com.creditlink.bean.po.index.BankCardFourElementAddedTempPo">
		select <include refid="busIndexBankFourElementAddedTempColumns"></include>
		from bus_index_bank_fourelement_added_temp bibfat
		where 1 = 1
		<include refid="findBusIndexBankFourElementAddedTempCondition"></include>
		limit 1
	</select>
	
	<!-- 更新状态 -->
	 <update id="updateStatusBatch" parameterType="com.creditlink.bean.bo.UpdateStatusBo">
	 	update bus_index_bank_fourelement_added_temp set STATUS = #{newStatus},UPDATEUSER = #{updateUser},UPDATETIME = #{updateTime}
	 	where  STATUS = #{oldStatus} and ID in(${ids})
	 </update>
	 
	 <!-- 查询条件 -->
	<sql id="fourElementAddedTempTodayQueryCondition">
		<if test="memberId != null">
			and bibfat.MEMBERID = #{memberId}
		</if>
		<if test="bankCard != null and bankCard !=''">
			and bibfat.BANKCARD = #{bankCard}
		</if>
		<if test="status != null and status !=''">
			and bibfat.STATUS = #{status}
		</if>
		<if test="createTime != null">
			and bibfat.CREATETIME = #{createTime}
		</if>
	</sql>
	
	<!-- 查询今日临时四要素索引数量 -->
	<select id="fourElementAddedTempTodayQueryCount" parameterType="java.util.Map" 
	 resultType="java.lang.Long">
	  select count(1) from bus_index_bank_fourelement_added_temp bibfat 
	  where 1 = 1 
	  <include refid="fourElementAddedTempTodayQueryCondition"></include>
	 </select>
	 
	 <!-- 查询今日临时四要素索引 -->
	<select id="fourElementAddedTempTodayQuery" parameterType="java.util.Map" 
	 	resultType="java.util.Map">
	  select <include refid="busIndexBankFourElementAddedTempColumns"></include> from bus_index_bank_fourelement_added_temp bibfat 
	  where 1 = 1 
	  <include refid="fourElementAddedTempTodayQueryCondition"></include>
	  order by bibfat.CREATETIME desc 
	  limit #{pageStart},#{pageSize}
	 </select>
	 
	  <!-- 更新-->
	<update id="update" parameterType="com.creditlink.bean.po.index.BankCardFourElementAddedTempPo">
		update bus_index_bank_fourelement_added_temp 
		<trim prefix="set" suffixOverrides=",">
			<if test="memberId != null">
				MEMBERID = #{memberId},
			</if>
			<if test="bankCard != null and bankCard != ''">
				BANKCARD = #{bankCard},
			</if>
			<if test="ip != null and ip != ''">
				IP = #{ip},
			</if>
			<if test="path != null and path != ''">
				PATH = #{path},
			</if>
			<if test="status != null and status != ''">
				STATUS = #{status},
			</if>
			<if test="updateTime != null">
				UPDATETIME = #{updateTime},
			</if>
			<if test="updateUser != null">
				UPDATEUSER = #{updateUser},
			</if>
		</trim>
		where ID = #{id}
	</update>
</mapper>